# Spatial_Audio_Framework

#TODO: User definable INTELMKL, SAF_ENABLE_SOFA reader
#AND INSTALL PATH for the dylib; make new test program that only uses cmake generated library, which is also generated by CMAKE 


cmake_minimum_required(VERSION 3.15)

# Configure project
project(saf VERSION 1.0.0 LANGUAGES C)
add_library(${PROJECT_NAME} SHARED)
set_target_properties(${PROJECT_NAME}
PROPERTIES
    VERSION ${PROJECT_VERSION}
    SOVERSION ${PROJECT_VERSION}
)

add_subdirectory(framework)

include(GNUInstallDirs)

add_compile_definitions(SAF_USE_INTEL_MKL)
set(INTEL_MKL_HEADER_PATH "/opt/intel/compilers_and_libraries/mac/mkl/include")
set(INTEL_MKL_LIB "/usr/local/lib/libsaf_mkl_custom.dylib")

target_include_directories(${PROJECT_NAME} 
PRIVATE 
    ${INTEL_MKL_HEADER_PATH}
)

target_link_libraries(${PROJECT_NAME}
PRIVATE 
    ${INTEL_MKL_LIB}
)

# sets the _EXPORT #define for the target (library)
# to ensure the functions are exported (visible)
target_compile_definitions(${PROJECT_NAME}
PRIVATE 
    -D_EXPORT
)

# specify the target to install (calculator library defined above)
# set the export name <name>-config (does not need to match target name)
# also specify where the .dylib/.so/.dll+.lib file should be installed
install(
    TARGETS ${PROJECT_NAME}
    EXPORT ${PROJECT_NAME}-config
    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR})

install(
    EXPORT ${PROJECT_NAME}-config
    NAMESPACE ${PROJECT_NAME}::
    DESTINATION ${CMAKE_INSTALL_LIBDIR}/cmake/${PROJECT_NAME})

install(
FILES 
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_cdf4sap/saf_cdf4sap.h 
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_hoa/saf_hoa.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_hrir/saf_hrir.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_reverb/saf_reverb.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_sh/saf_sh.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_sofa_reader/saf_sofa_reader.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_bessel.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_complex.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_decor.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_erb.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_error.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_fft.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_filters.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_sensorarray_presets.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_sort.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_matrixConv.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_loudspeaker_presets.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_misc.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_pitch.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_utilities.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_utilities/saf_veclib.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/modules/saf_vbap/saf_vbap.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/resources/afSTFT/afSTFTlib.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/resources/convhull_3d/convhull_3d.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/resources/kissFFT/kiss_fft.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/resources/kissFFT/kiss_fftr.h
    ${CMAKE_CURRENT_SOURCE_DIR}/framework/resources/md_malloc/md_malloc.h 
DESTINATION 
    ${CMAKE_INSTALL_INCLUDEDIR}/${PROJECT_NAME})

install(
    DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/framework/include/ 
    DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/${PROJECT_NAME})


 